" Set space as leader key
let mapleader = " "

" General settings
set scrolloff=5
set incsearch
set showmode
set number
set relativenumber
set clipboard+=unnamed
set ignorecase
set smartcase
set ideajoin

" Enable IdeaVim plugins
set surround
set commentary
set highlightedyank
set exchange
set multiple-cursors
set which-key

" Disable timeout for better which-key experience
set notimeout

" Key mappings
" Commentary
noremap <leader>/ :action CommentByLineComment<CR>

" IDE actions
map <leader>ru <Action>(Run)
map <leader>rn <Action>(RenameElement)
map <leader>de <Action>(Debug)
map <leader>db <Action>(ToggleLineBreakpoint)
map <leader>gd <Action>(GotoDeclaration)
map <leader>gi <Action>(GotoImplementation)
map <leader>fu <Action>(FindUsages)
map <leader>ff <Action>(GotoFile)
map <leader>fc <Action>(GotoClass)
map <leader>fs <Action>(GotoSymbol)
map <leader>o <Action>(FileStructurePopup)

" Reformat current line
map <leader>l V<Action>(ReformatCode)

" Navigation
map <C-o> <Action>(Back)
map <C-i> <Action>(Forward)

" Move to beginning/end of line
nnoremap H ^
nnoremap L $

" Move selected lines up/down
vnoremap J :m '>+1<CR>gv=gv
vnoremap K :m '<-2<CR>gv=gv

" Redo
nnoremap U <C-R>

" Quick edit and reload of .ideavimrc
nnoremap <leader>vv :e ~/.ideavimrc<CR>
nnoremap <leader>vr :source ~/.ideavimrc<CR>

" Buffer and window management
nnoremap <leader>q :action CloseContent<CR>
nnoremap <leader>qa :action CloseAllEditors<CR>
nnoremap <leader>qo :action CloseAllEditorsButActive<CR>

" Tab navigation
nnoremap <leader>1 :action GoToTab1<CR>
nnoremap <leader>2 :action GoToTab2<CR>
nnoremap <leader>3 :action GoToTab3<CR>
nnoremap <leader>4 :action GoToTab4<CR>
nnoremap <leader>5 :action GoToTab5<CR>
nnoremap <leader>6 :action GoToTab6<CR>
nnoremap <leader>7 :action GoToTab7<CR>
nnoremap <leader>8 :action GoToTab8<CR>
nnoremap <leader>9 :action GoToTab9<CR>

" Navigate to next/previous tabs
nnoremap <leader>] :action NextTab<CR>
nnoremap <leader>[ :action PreviousTab<CR>

" Zen mode
nnoremap <leader>z :action ToggleDistractionFreeMode<CR>

" Better escape
inoremap jk <Esc>

" Go to next error
nnoremap <S-Space> :action GotoNextError<CR>

" Search everywhere (alternative to double shift)
nnoremap <leader>se :action SearchEverywhere<CR>

" Find Action (Cmd+Shift+A equivalent)
nnoremap <leader>a :action GotoAction<CR>

" Terminal
nnoremap <leader>t :action ActivateTerminalToolWindow<CR>

" Recent files (with redraw to ensure immediate display)
nnoremap <leader>r :action RecentFiles<CR>:redraw<CR>

" Find in path
nnoremap <leader>fp :action FindInPath<CR>

" Toggle project view (corrected action)
nnoremap <leader>p :action ActivateProjectToolWindow<CR>

" AceJump (alternative to EasyMotion)
map <leader>e :action AceAction<CR>
map <leader>w :action AceTargetAction<CR>

" Refactoring
map <leader>rf :action Refactorings.QuickListPopupAction<CR>

" Show intention actions
map <leader>i :action ShowIntentionActions<CR>

" Toggle breakpoint
map <leader>b :action ToggleLineBreakpoint<CR>

" multicursor
map <M-n> <A-n>
map <M-x> <A-x>
map <M-p> <A-p>

" Create new file
nnoremap <leader>nf :action NewFile<CR>

" Create new directory
nnoremap <leader>nd :action NewDir<CR>

" reopen closed tab
nnoremap <leader>ro :action ReopenClosedTab<CR>

" toggle soft wrap
nnoremap <leader>sw :action EditorToggleUseSoftWraps<CR>

" Split window
nnoremap <leader>sv :action SplitVertically<CR>
nnoremap <leader>sh :action SplitHorizontally<CR>

" Move between splits
nnoremap <C-h> <C-w>h
nnoremap <C-j> <C-w>j
nnoremap <C-k> <C-w>k
nnoremap <C-l> <C-w>l

" Increase/decrease split size
nnoremap <leader>+ :action StretchSplitToRight<CR>
nnoremap <leader>- :action StretchSplitToLeft<CR>

" Quick documentation
nnoremap K :action QuickJavaDoc<CR>

" Quick implementation
nnoremap <leader>qi :action QuickImplementations<CR>

" Show usages
nnoremap <leader>su :action ShowUsages<CR>

" Optimize imports
nnoremap <leader>oi :action OptimizeImports<CR>