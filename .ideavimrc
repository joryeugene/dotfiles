" Set space as leader key
let mapleader = " "

" General settings
set clipboard+=unnamed
set ideajoin
set ignorecase
set incsearch
set number
set relativenumber
set scrolloff=5
set showmode
set smartcase

" Enable IdeaVim plugins
set NERDTree
set commentary
set exchange
set highlightedyank
set multiple-cursors
set surround
set which-key

" Disable timeout for better which-key experience
set notimeout

" Key mappings
" Commentary
noremap <leader>/ :action CommentByLineComment<CR>

" IDE actions
map <leader>ru :action Run<CR>
map <leader>de :action Debug<CR>
map <leader>st :action Stop<CR>
map <leader>tb :action ToggleLineBreakpoint<CR>
map <leader>df :action ToggleDistractionFreeMode<CR>

" Navigation
map <C-o> :action Back<CR>
map <C-i> :action Forward<CR>
map <leader>gc :action GotoClass<CR>
map <leader>gd :action GotoDeclaration<CR>
map <leader>ge :action GotoNextError<CR>
map <leader>gf :action GotoFile<CR>
map <leader>gi :action GotoImplementation<CR>
map <leader>gp :action GotoPreviousError<CR>
map <leader>gs :action GotoSymbol<CR>
map <leader>gt :action GotoTest<CR>
map <leader>gu :action ShowUsages<CR>

" Refactoring
map <leader>re :action Refactorings.QuickListPopupAction<CR>
map <leader>rf :action IntroduceField<CR>
map <leader>ri :action Inline<CR>
map <leader>rm :action ExtractMethod<CR>
map <leader>rn :action RenameElement<CR>
map <leader>rp :action IntroduceParameter<CR>
map <leader>rv :action IntroduceVariable<CR>

" Windows and splits
map <leader>sv :action SplitVertically<CR>
map <leader>sh :action SplitHorizontally<CR>
map <leader>sc :action Unsplit<CR>
map <leader>sm :action MoveEditorToOppositeTabGroup<CR>
map <leader>sw :action EditorToggleUseSoftWraps<CR>

" Move between splits
nnoremap <C-h> <C-w>h
nnoremap <C-j> <C-w>j
nnoremap <C-k> <C-w>k
nnoremap <C-l> <C-w>l

" Tabs
map <leader>] :action NextTab<CR>
map <leader>[ :action PreviousTab<CR>

" Tool windows
map <leader>tt :action ActivateTerminalToolWindow<CR>
map <leader>tp :action ActivateProjectToolWindow<CR>
map <leader>ts :action ActivateStructureToolWindow<CR>
map <leader>td :action ActivateDebugToolWindow<CR>
map <leader>tr :action ActivateRunToolWindow<CR>

" Search and replace
map <leader>ff :action FindInPath<CR>
map <leader>rr :action ReplaceInPath<CR>

" Other useful actions
map <leader>x :action CloseContent<CR>
map <leader>qq :action CloseAllEditors<CR>
map <leader>qo :action CloseAllEditorsButActive<CR>
map <leader>si :action ShowIntentionActions<CR>
map <leader>pi :action ParameterInfo<CR>
map <leader>sd :action ShowErrorDescription<CR>
map <leader>hw :action HideAllWindows<CR>
map <leader>me :action MaximizeEditorInSplit<CR>

" Save
nnoremap <leader>w :action SaveAll<CR>

" Move to beginning/end of line
nnoremap H ^
nnoremap L $

" Move selected lines up/down
vnoremap J :m '>+1<CR>gv=gv
vnoremap K :m '<-2<CR>gv=gv

" Redo
nnoremap U <C-R>

" Quick edit and reload of .ideavimrc
nnoremap <leader>ve :e ~/.ideavimrc<CR>
nnoremap <leader>vr :source ~/.ideavimrc<CR>

" Version control
map <leader>vv :action Vcs.QuickListPopupAction<CR>

" Better escape
inoremap jk <Esc>

" AceJump
"map <leader>aj :action AceAction<CR>

" Multicursor
map <M-n> <A-n>
map <M-x> <A-x>
map <M-p> <A-p>

" Quick documentation
nnoremap K :action QuickJavaDoc<CR>

" Optimize imports
nnoremap <leader>oi :action OptimizeImports<CR>

" Go to exact window
nnoremap <leader>1 :action GoToTab1<CR>
nnoremap <leader>2 :action GoToTab2<CR>
nnoremap <leader>3 :action GoToTab3<CR>
nnoremap <leader>4 :action GoToTab4<CR>
nnoremap <leader>5 :action GoToTab5<CR>
nnoremap <leader>6 :action GoToTab6<CR>
nnoremap <leader>7 :action GoToTab7<CR>
nnoremap <leader>8 :action GoToTab8<CR>
nnoremap <leader>9 :action GoToTab9<CR>

" Toggle soft wrap
nnoremap <leader>tw :action EditorToggleUseSoftWraps<CR>

" Reformat code
map <leader>fc :action ReformatCode<CR>

" Find action
nnoremap <leader>fa :action GotoAction<CR>

" Recent files
nnoremap <leader>e :action RecentFiles<CR>

" Search everywhere
nnoremap <leader>se :action SearchEverywhere<CR>

" Create new file
nnoremap <leader>nf :action NewFile<CR>

" Create new directory
nnoremap <leader>nd :action NewDir<CR>

" Project tree navigation with hjkl
map <leader>pt :action ActivateProjectToolWindow<CR>

" Navigation in the navigation bar
nnoremap h <Left>
nnoremap j <Down>
nnoremap k <Up>
nnoremap l <Right>

" NERDTree
"Key 	Description 	Map Setting
"o 	Open files, directories and bookmarks 	g:NERDTreeMapActivateNode
"go 	Open selected file, but leave cursor in the NERDTree 	g:NERDTreeMapPreview
"t 	Open selected node/bookmark in a new tab 	g:NERDTreeMapOpenInTab
"T 	Same as 't' but keep the focus on the current tab 	g:NERDTreeMapOpenInTabSilent
"i 	Open selected file in a split window 	g:NERDTreeMapOpenSplit
"gi 	Same as i, but leave the cursor on the NERDTree 	g:NERDTreeMapPreviewSplit
"s 	Open selected file in a new vsplit 	g:NERDTreeMapOpenVSplit
"gs 	Same as s, but leave the cursor on the NERDTree 	g:NERDTreeMapPreviewVSplit
"O 	Recursively open the selected directory 	g:NERDTreeMapOpenRecursively
"x 	Close the current nodes parent 	g:NERDTreeMapCloseDir
"X 	Recursively close all children of the current node 	g:NERDTreeMapCloseChildren
"P 	Jump to the root node 	g:NERDTreeMapJumpRoot
"p 	Jump to current nodes parent 	g:NERDTreeMapJumpParent
"K 	Jump up inside directories at the current tree depth 	g:NERDTreeMapJumpFirstChild
"J 	Jump down inside directories at the current tree depth 	g:NERDTreeMapJumpLastChild
"<C-J> 	Jump down to next sibling of the current directory 	g:NERDTreeMapJumpNextSibling
"<C-K> 	Jump up to previous sibling of the current directory 	g:NERDTreeMapJumpPrevSibling
"r 	Recursively refresh the current directory 	g:NERDTreeMapRefresh
"R 	Recursively refresh the current root 	g:NERDTreeMapRefreshRoot
"m 	Display the NERDTree menu 	g:NERDTreeMapMenu
"q 	Close the NERDTree window 	g:NERDTreeMapQuit
"A 	Zoom (maximize/minimize) the NERDTree window 	g:NERDTreeMapToggleZoom
"d 	Delete file or directory 	g:NERDTreeMapDelete
"n 	Create File 	g:NERDTreeMapNewFile
"N 	Create Directory 	g:NERDTreeMapNewDir